<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Dashboard - CyberSmrt</title>

  <!-- (Optional) Orbitron for headings to match brand -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&display=swap" rel="stylesheet"/>

  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{
      --bg1:#0a0a0a; --bg2:#1a1a2e; --fg:#fff; --muted:#b0b0b0;
      --acc:#667eea; --acc2:#764ba2; --panel:rgba(255,255,255,.05);
      --stroke:rgba(255,255,255,.1);
    }
    body{
      font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;
      background:linear-gradient(135deg,var(--bg1) 0%,var(--bg2) 100%);
      color:var(--fg);
      min-height:100dvh;
    }
    .wrap{max-width:1200px;margin:0 auto;padding:20px}
    header.dashboard{
      background:var(--panel); border:1px solid var(--stroke);
      border-radius:20px; padding:22px; margin:16px 0 30px; backdrop-filter:blur(10px)
    }
    .head-row{
      display:flex; gap:12px; justify-content:space-between; align-items:flex-end; flex-wrap:wrap
    }
    h1{
      font-family:"Orbitron",system-ui,sans-serif; letter-spacing:.02em; font-weight:900;
      background:linear-gradient(135deg,var(--acc),var(--acc2));
      -webkit-background-clip:text; background-clip:text; color:transparent;
      font-size:2.2rem; line-height:1.1;
    }
    .subtitle{color:var(--muted); margin-top:6px}
    .actions-inline{display:flex; gap:10px; flex-wrap:wrap}
    .btn{
      padding:10px 16px; border-radius:10px; border:1px solid var(--stroke);
      background:rgba(255,255,255,.06); color:#fff; text-decoration:none; font-weight:700; display:inline-flex; align-items:center; gap:8px;
    }
    .btn:hover{ background:rgba(102,126,234,.2); border-color:var(--acc) }
    .btn-primary{ background:linear-gradient(135deg,var(--acc),var(--acc2)); border:none }
    .btn-primary:hover{ filter:brightness(1.05) }
    .user-info{
      display:flex; align-items:center; gap:10px; margin-top:16px; padding-top:16px; border-top:1px solid var(--stroke); color:var(--muted)
    }
    .user-badge{
      background:linear-gradient(135deg,var(--acc),var(--acc2)); color:#fff; padding:4px 12px; border-radius:14px; font-weight:700; font-size:.85rem
    }
    .security-badge{
      display:inline-flex; align-items:center; gap:8px; background:rgba(16,185,129,.1);
      border:1px solid rgba(16,185,129,.3); color:#10b981; padding:6px 12px; border-radius:18px; font-weight:700; font-size:.85rem
    }

    /* Stats */
    .stats-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:18px; margin-bottom:32px }
    .stat-card{ text-align:center; background:var(--panel); border:1px solid var(--stroke); border-radius:15px; padding:20px }
    .stat-number{
      font-size:2.2rem; font-weight:900;
      background:linear-gradient(135deg,#fff,#d7d7d7);
      -webkit-background-clip:text; background-clip:text; color:transparent; margin-bottom:4px
    }
    .stat-label{ color:var(--muted); font-size:.95rem }
    .stat-sub{ color:var(--muted); font-size:.85rem; margin-top:6px }

    /* Quick actions blocks */
    .block{
      background:var(--panel); border:1px solid var(--stroke);
      border-radius:20px; padding:22px; margin-bottom:28px
    }
    .block h2{ color:var(--acc); margin-bottom:14px }
    .action-buttons{ display:flex; flex-wrap:wrap; gap:12px }

    /* Tools */
    .tools-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:18px }
    .tool-card{
      display:block; text-decoration:none; color:inherit; cursor:pointer;
      background:var(--panel); border:1px solid var(--stroke); border-radius:15px; padding:22px; transition:.25s
    }
    .tool-card:hover{ transform:translateY(-4px); border-color:var(--acc); box-shadow:0 12px 26px rgba(102,126,234,.22); background:rgba(102,126,234,.08) }
    .tool-icon{ font-size:2.4rem; margin-bottom:10px }
    .tool-card h3{ font-size:1.3rem; margin-bottom:6px }
    .tool-card p{ color:var(--muted); margin-bottom:16px; line-height:1.55 }
    .tool-card .btn{ margin-top:4px }

    footer{ text-align:center; color:#777; padding:20px; margin:26px 0 32px }

    @media (max-width:768px){
      h1{ font-size:1.8rem }
    }
  </style>
</head>
<body>
  <!-- Shared header -->
  <div id="header-mount"></div>
  <script defer src="/assets/js/header-loader.js"></script>
  <script defer src="/assets/js/header-init.js"></script>

  <main class="wrap">
    <header class="dashboard" role="banner">
      <div class="head-row">
        <div>
          <h1>🛡️ CyberSmrt Admin Dashboard</h1>
          <p class="subtitle">Content Management & Site Administration</p>
        </div>
        <div class="actions-inline">
          <a class="btn" href="/" aria-label="View public site">🏠 View Site</a>
          <a class="btn" href="/blog/index.html" aria-label="Open blog">📰 View Blog</a>
          <a class="btn btn-primary" href="/admin/index.html" aria-label="Create new blog post">➕ New Post</a>
        </div>
      </div>
      <div class="user-info">
        <span>👤 Logged in as:</span>
        <span id="username" class="user-badge">Admin</span>
        <span class="security-badge" aria-live="polite">🔒 Secure Session</span>
      </div>
    </header>

    <!-- Stats -->
    <section class="stats-grid" aria-label="Blog statistics">
      <div class="stat-card">
        <div id="postCount" class="stat-number">—</div>
        <div class="stat-label">Blog Posts</div>
        <div id="draftCount" class="stat-sub"></div>
      </div>
      <div class="stat-card">
        <div id="lastUpdated" class="stat-number">—</div>
        <div class="stat-label">Last Updated</div>
      </div>
      <div class="stat-card">
        <div class="stat-number">Active</div>
        <div class="stat-label">Site Status</div>
      </div>
      <div class="stat-card">
        <div class="stat-number">100%</div>
        <div class="stat-label">Uptime</div>
      </div>
    </section>

    <!-- Quick links -->
    <section class="block" aria-labelledby="quick-actions">
      <h2 id="quick-actions">⚡ Quick Actions</h2>
      <div class="action-buttons">
        <a class="btn" href="/" aria-label="View public site">🏠 View Public Site</a>
        <a class="btn" href="/blog/index.html" aria-label="Open blog index">📝 View Blog</a>
        <a class="btn" href="https://github.com/cybersmrt-tony/cybersmrt-web" target="_blank" rel="noopener noreferrer">💻 GitHub Repo</a>
        <a class="btn" href="https://dash.cloudflare.com" target="_blank" rel="noopener noreferrer">☁️ Cloudflare Dashboard</a>
      </div>
    </section>

    <!-- Tools -->
    <h2 style="color:var(--acc);margin:10px 0 14px;font-size:1.6rem">🛠️ Admin Tools</h2>
    <section class="tools-grid" aria-label="Admin tools">
      <a class="tool-card" href="/admin/index.html">
        <div class="tool-icon">📝</div>
        <h3>Blog Post Generator</h3>
        <p>Create new blog posts with visual editing, rich text formatting, images, videos, and tables.</p>
        <span class="btn">Open Generator →</span>
      </a>

      <a class="tool-card" href="https://github.com/cybersmrt-tony/cybersmrt-web/blob/main/blog-data.json" target="_blank" rel="noopener noreferrer">
        <div class="tool-icon">📊</div>
        <h3>Blog Data Manager</h3>
        <p>View and edit your blog database. Manage metadata, featured posts, and content.</p>
        <span class="btn">Manage Data →</span>
      </a>

      <a class="tool-card" href="https://github.com/cybersmrt-tony/cybersmrt-web/tree/main/assets" target="_blank" rel="noopener noreferrer">
        <div class="tool-icon">📁</div>
        <h3>File Manager</h3>
        <p>Upload and manage images, logos, and other assets for your website.</p>
        <span class="btn">Manage Files →</span>
      </a>

      <a class="tool-card" href="https://github.com/cybersmrt-tony/cybersmrt-web/tree/main/assets/brand" target="_blank" rel="noopener noreferrer">
        <div class="tool-icon">🎨</div>
        <h3>Brand Assets</h3>
        <p>Access logos, color palettes, fonts, and brand guidelines.</p>
        <span class="btn">View Assets →</span>
      </a>

      <a class="tool-card" href="https://dash.cloudflare.com" target="_blank" rel="noopener noreferrer">
        <div class="tool-icon">⚙️</div>
        <h3>Site Settings</h3>
        <p>Configure domain, SSL, environment variables, and deployment settings.</p>
        <span class="btn">Open Settings →</span>
      </a>

      <a class="tool-card" href="https://dash.cloudflare.com" target="_blank" rel="noopener noreferrer">
        <div class="tool-icon">📈</div>
        <h3>Analytics</h3>
        <p>View traffic stats, visitor analytics, and site performance metrics.</p>
        <span class="btn">View Analytics →</span>
      </a>
    </section>

    <!-- Docs -->
    <section class="block" aria-labelledby="docs">
      <h2 id="docs">📚 Documentation</h2>
      <div class="action-buttons">
        <a class="btn" href="https://github.com/cybersmrt-tony/cybersmrt-web/blob/main/README.md" target="_blank" rel="noopener noreferrer">📖 README</a>
        <a class="btn" href="https://github.com/cybersmrt-tony/cybersmrt-web/blob/main/BLOG_SETUP.md" target="_blank" rel="noopener noreferrer">🚀 Blog Setup Guide</a>
        <a class="btn" href="https://github.com/cybersmrt-tony/cybersmrt-web/blob/main/AUTH_SETUP.md" target="_blank" rel="noopener noreferrer">🔐 Security Guide</a>
        <a class="btn" href="https://github.com/cybersmrt-tony/cybersmrt-web/blob/main/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer">🤝 Contributing</a>
      </div>
    </section>

    <footer>
      <p>© 2025 CyberSmrt. All rights reserved.</p>
      <p style="margin-top:10px;font-size:.9rem">EIN: 33-3117801 | Service-Disabled Veteran-Owned 501(c)(3)</p>
    </footer>
  </main>

  <!-- Shared footer -->
  <div id="footer-mount"></div>
  <script defer src="/assets/js/footer-loader.js"></script>
<script defer src="/assets/js/footer-init.js"></script>

  <script>
    // Username from session (client-side demo auth)
    const user = sessionStorage.getItem('blog_user') || 'Admin';
    const userEl = document.getElementById('username');
    if (userEl) userEl.textContent = user;

    // Blog stats (with cache-bust + robust parsing)
    (function loadStats() {
      const cacheBust = 'v=' + Date.now();
      const url = '/blog-data.json?' + cacheBust; // adjust path if you keep it elsewhere

      const postCountEl = document.getElementById('postCount');
      const lastUpdatedEl = document.getElementById('lastUpdated');
      const draftCountEl = document.getElementById('draftCount');

      // Show loading placeholders
      if (postCountEl) postCountEl.textContent = '…';
      if (lastUpdatedEl) lastUpdatedEl.textContent = '…';

      fetch(url, { credentials: 'omit' })
        .then(r => r.ok ? r.json() : Promise.reject(new Error(r.status + ' ' + r.statusText)))
        .then(data => {
          const posts = Array.isArray(data.posts) ? data.posts.slice() : [];

          // Optional: count drafts if you store status
          const drafts = posts.filter(p => (p.status || '').toLowerCase() === 'draft').length;
          if (draftCountEl) draftCountEl.textContent = drafts ? drafts + ' draft(s)' : '';

          if (postCountEl) postCountEl.textContent = posts.length.toString();

          if (posts.length) {
            // Sort by date desc (fallbacks handled)
            posts.sort((a,b) => new Date(b.date || 0) - new Date(a.date || 0));
            const latest = new Date(posts[0].date || Date.now());
            const today = new Date();
            const diffDays = Math.floor((today - latest) / 86400000);
            let label = '—';
            if (isNaN(diffDays)) {
              label = 'Unknown';
            } else if (diffDays === 0) {
              label = 'Today';
            } else if (diffDays === 1) {
              label = 'Yesterday';
            } else {
              label = diffDays + ' days ago';
            }
            if (lastUpdatedEl) lastUpdatedEl.textContent = label;
          } else {
            if (lastUpdatedEl) lastUpdatedEl.textContent = '—';
          }
        })
        .catch(err => {
          console.warn('Could not load blog stats:', err);
          if (postCountEl) postCountEl.textContent = '0';
          if (lastUpdatedEl) lastUpdatedEl.textContent = '—';
          if (draftCountEl) draftCountEl.textContent = '';
        });
    })();
  </script>
</body>
</html>